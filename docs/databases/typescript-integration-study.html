<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-databases/typescript-integration-study" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">PostgreSQL isolation transaction | Maatth.github.io</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://maatth.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://maatth.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://maatth.github.io/docs/databases/typescript-integration-study"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="PostgreSQL isolation transaction | Maatth.github.io"><meta data-rh="true" name="description" content="This article illustrates some behaviours of the various transaction isolation settings described in the official PostgreSQL documentation//www.postgresql.org/docs/12/transaction-iso.html. It is recommended to read it first."><meta data-rh="true" property="og:description" content="This article illustrates some behaviours of the various transaction isolation settings described in the official PostgreSQL documentation//www.postgresql.org/docs/12/transaction-iso.html. It is recommended to read it first."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://maatth.github.io/docs/databases/typescript-integration-study"><link data-rh="true" rel="alternate" href="https://maatth.github.io/docs/databases/typescript-integration-study" hreflang="en"><link data-rh="true" rel="alternate" href="https://maatth.github.io/docs/databases/typescript-integration-study" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Maatth.github.io RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Maatth.github.io Atom Feed"><link rel="stylesheet" href="/assets/css/styles.b54ed7d7.css">
<link rel="preload" href="/assets/js/runtime~main.d8d9fa14.js" as="script">
<link rel="preload" href="/assets/js/main.a4125f30.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/typescript">TypeScript</a><button aria-label="Toggle the collapsible sidebar category &#x27;TypeScript&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/databases">Databases</a><button aria-label="Toggle the collapsible sidebar category &#x27;Databases&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/databases/typescript-integration-study">PostgreSQL isolation transaction</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/databases"><span itemprop="name">Databases</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">PostgreSQL isolation transaction</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>PostgreSQL isolation transaction</h1><p>This article illustrates some behaviours of the various transaction isolation settings described in the official PostgreSQL documentation: <a href="https://www.postgresql.org/docs/12/transaction-iso.html" target="_blank" rel="noopener noreferrer">https://www.postgresql.org/docs/12/transaction-iso.html</a>. It is recommended to read it first.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reminders">Reminders<a href="#reminders" class="hash-link" aria-label="Direct link to Reminders" title="Direct link to Reminders">​</a></h2><p>This section contains quick reminders from the PostgreSQL documentation.</p><p>A transaction begins with the BEGIN command and is validated by the COMMIT command. Each SQL query is automatically encapsulated in a transaction by PostgreSQL.</p><p>The SQL standard describes 4 problems (phenomena) to avoid when executing a transaction:</p><ul><li><strong>dirty read</strong>: occur when one transaction reads data written by another, uncommitted, transaction. The danger with dirty reads is that the other transaction might never commit, leaving the original transaction with &quot;dirty&quot; data.</li><li><strong>nonrepeatable read</strong>: A transaction re-reads data (during the same transaction) it has previously read and finds that data has been modified by another transaction (that committed since the initial read)</li><li><strong>phantom read</strong>: A transaction re-executes a query returning a set of rows that satisfy a search condition and finds that the set of rows satisfying the condition has changed due to another recently-committed transaction</li><li><strong>serialization anomaly</strong>: The result of successfully committing a group of transactions is inconsistent with all possible orderings of running those transactions one at a time</li></ul><p>The SQL standard describes 4 transaction isolation modes that will be used to progressively prevent its phenomena (in order of tolerance to the phenomena):</p><ol><li>Read Uncommitted</li><li>Read committed</li><li>Repeatable Read</li><li>Serializable</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="read-uncommitted">Read Uncommitted<a href="#read-uncommitted" class="hash-link" aria-label="Direct link to Read Uncommitted" title="Direct link to Read Uncommitted">​</a></h2><p>It is the weakest isolation level because it can read the data which are acquired exclusive lock to the resources by the other transactions (unlike &quot;read committed&quot;) So, it might help to avoid locks and deadlock problems for the data reading operations. It can be used to debug inside a transaction. In PostgreSQL, this isolation mode behaves like &quot;Read Committed&quot;.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="read-committed">Read Committed<a href="#read-committed" class="hash-link" aria-label="Direct link to Read Committed" title="Direct link to Read Committed">​</a></h2><p>This is the default transaction isolation.</p><p>In this mode, each request sees all already validated data (before the beginning of the transaction). In the following example, we simulate the concurrent access of two transactions by the use of two consoles in which the commands are executed. So the SELECT query in console 2 (<font color="#FF4500">(1)</font>  below) sees 123 (and not 124) because the UPDATE in console 1 has not yet been committed in the other transactions (because COMMIT is executed after SELECT):</p><p><img loading="lazy" alt="1" src="/assets/images/1-13882cb6699c35cc513f1cef88044c6b.png" width="1233" height="327" class="img_ev3q"></p><p>The two consoles in which the commands are executed simulate the concurrent access of two transactions.</p><p>Thus, in the same transaction, if a second SELECT is executed after the validation of the transaction from console 1, it will see 124. See <font color="#FF4500">(2)</font> below. This
behaviour is called <strong>&quot;nonrepeatable read&quot;</strong> and is one of the 4 phenomena that we try to avoid.</p><p><img loading="lazy" alt="2" src="/assets/images/2-c106ed9d03cd54d9d9972128faa7dbdb.png" width="1236" height="350" class="img_ev3q"></p><p>This SELECT (<font color="#FF4500">(3)</font> below) can see the result of previous query that are in the same transaction (even though they are not committed). Example, the SELECT (<font color="#FF4500">(3)</font> below) will return 151.</p><p><img loading="lazy" alt="3" src="/assets/images/3-ba6a32d4cb6009084619a7cca37e0b7c.png" width="1223" height="303" class="img_ev3q"></p><p>For the UPDATE, DELETE commands, this behaviour is a little bit different since if the line they update is also modified by another transaction, these commands will wait for the end of this other transaction (either the cancellation or the validation), then use its result. In the example below, the UPDATE of console 2 <font color="#FF4500">(4)</font> will see 124 (result of the transaction on the left after the commit) and will return 125.</p><p><img loading="lazy" alt="4" src="/assets/images/4-50e4a2060fd1869a5513b7396b387787.png" width="1239" height="326" class="img_ev3q"></p><p>The same behaviour as UPDATE and DELETE can be obtained with SELECT by adding the FOR UPDATE or FOR SHARE clause. For example:</p><p><code>SELECT balance FROM account WHERE account_num = 9 FOR UDPATE;</code> </p><p>will wait for other transactions that concern this row to finish.</p><p>When UPDATE is executed (after the wait), its WHERE clause is re-evaluated to make sure it&#x27;s the same row that it is modifying. If the row no longer matches the WHERE clause, the UPDATE is canceled.</p><p>This re-evaluation then cancellation can also cause unexpected behaviour: the phenomenon of <strong>&quot;phantom read&quot;</strong>. For example the following DELETE will not delete any line:</p><p><img loading="lazy" alt="5" src="/assets/images/5-1d0b31c7bf96d53e53fcf8e92566e15b.png" width="1228" height="307" class="img_ev3q"></p><p>Because, after the transaction in console 1 updates all the lines, the DELETE of console 2 (<font color="#FF4500">(5)</font> above) will:</p><ul><li>evaluate its WHERE clause (which only concerns the row of id 2),</li><li>then wait for the first transaction to finish because it modifies this line too.</li><li>reevaluate the WHERE clause only for row of id 2</li><li>the balance of this line no longer checks the WHERE clause so the DELETE is canceled.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="repeatable-read">Repeatable Read<a href="#repeatable-read" class="hash-link" aria-label="Direct link to Repeatable Read" title="Direct link to Repeatable Read">​</a></h2><p>Unlike the <strong>&quot;Read Committed&quot;</strong> mode, this mode will only see the data validated before the start of the transaction. Thus, the phenomenon of <strong>&quot;nonrepeatable read&quot;</strong> becomes impossible and the SELECT <font color="#FF4500">(6)</font> below returns the same result as the previous SELECT.</p><p><img loading="lazy" alt="6" src="/assets/images/6-8c36fa2d4856e7c22a5009d707ba024a.png" width="1232" height="346" class="img_ev3q"></p><p>The behaviour of UPDATE, DELETE, SELECT FOR UPDATE / SHARE will change: instead of waiting for the result of the concurrent transaction (see <font color="#FF4500">(4)</font>), the transaction will be rolled back with the message:
<em>&quot;ERROR: could not serialize access due to concurrent update&quot; (see <font color="#FF4500">(7)</font> below)</em></p><p><img loading="lazy" alt="7" src="/assets/images/7-3ab5d7cfd50ff13e4c5561356cdaa5fe.png" width="1235" height="313" class="img_ev3q"></p><p>So it will be necessary to implement retry mechanisms when this error occurs.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>To summarise</div><div class="admonitionContent_S0QG"><p>The differences with &quot;Read Committed&quot; mode are:</p><ul><li>advantage: avoids the <strong>&quot;non repeatable read&quot;</strong> and <strong>&quot;phantom read&quot;</strong> phenomena.</li><li>drawback: requires the implementation of retry.</li></ul></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="serializable">Serializable<a href="#serializable" class="hash-link" aria-label="Direct link to Serializable" title="Direct link to Serializable">​</a></h2><p>This mode has the same behaviour as &quot;Repeatable Read&quot;, but it will also check that the database modifications are identical even if the execution order of the concurrent transactions is changed.</p><p>In the following example:</p><ul><li>the transaction in console 1 sums the values of class 1, then inserts the result with a class 2 <font color="#FF4500">(8)</font></li><li>the transaction in console 2 sums the values of class 2, then inserts the result with a class 1</li></ul><p><img loading="lazy" alt="8" src="/assets/images/8-fdcda32c91c6051e0624752f4710a81b.png" width="1230" height="481" class="img_ev3q"></p><p>In this case, PostgreSQL will check if the result is the same by first executing the transaction from console 2 before the transaction from console 1.</p><p><img loading="lazy" alt="9" src="/assets/images/9-2ca1c128136d600d79594ca736f9c6ac.png" width="1232" height="482" class="img_ev3q"></p><p>Here, the result of the table is not the same after the inversion <font color="#FF4500">(9)</font>, so the transaction of console 1 will be committed, but the one of console 2 will be rolled back.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>To summarise</div><div class="admonitionContent_S0QG"><p>The differences with &quot;Repeatable Read&quot; mode are:</p><ul><li>advantage: avoids the &quot;serialization anomaly&quot; phenomenon.</li><li>disadvantage: is more expensive in computation than the two other modes (except if one abuses the explicit locks FOR UPDATE / SHARE).</li></ul></div></div><p>TLDR
imaginez qu&#x27;il y a deux transactions (dont un commence avant l&#x27;autre). La 1ere fait un update sur une ligne et l&#x27;autre lit cette ligne juste après (ou fait aussi un update). Qu&#x27;est ce qui se passe ? La valeur lue est-elle celle avant le début de la première transaction ou après celle-ci ?
Et bien, ca dépend de ce vous choisissez comme mode d&#x27;isolation entre transaction. Un peu comme pour définir un degré d&#x27;indépendance entre ces deux transactions.
Pour nous aider à choisir, le standard SQL a défini 4 pb que l&#x27;on voudra (ou pas) éviter :
dirty read : (lecture sans se soucier des autres transactions)
nonrepeatable read : une transaction lit deux fois une ligne mais le second résultat diffère par rapport à la première lecture.
phantom read : pareil mais entre temps, la ligne a carrément disparue !
serialization anomaly : le resultat dépend de l&#x27;ordre d&#x27;execution des transactions :(</p><p>Dans sa grande bonté, à chaque pb est associé un mode d&#x27;interaction entre transaction appelé &quot;mode d&#x27;isolation&quot;. C&#x27;est-à-dire que chaque mode va empecher un nb croissant de ces pb.</p><p>Read committed:
T1 update et T2 select : le select lit uniquement ce qui est validé (ne voit pas le update) (sauf si FOR UPDATE)
T1 update et T2 update (ou delete) : T2 attend la fin de T1 pour recalculer le where. Si ca retourne la meme ligne, T2 continue, sinon l&#x27;update est ignoré. (si T1 roll back, alors on prend la valeur d&#x27;avant T1)
donc regarde la valeur avant T1 (pour les select) et après T2 (pour update et delete), dans tt les cas c&#x27;est validé, donc plus de dirty read
mais il reste non repeatable read phenomene car la valeur lue avant peut-etre modifiée par T1</p><p>repetable read : pareil qu&#x27;au dessus (attente que T1 finisse) pour le select, mais error si T2 update, delete ou select for update </p><p>serializable : vérifie le meme résultat si ordre des transaction change (très consommateur de ressources)</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/databases/typescript-integration-study.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/databases"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Databases</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/devops"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">DevOps</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#reminders" class="table-of-contents__link toc-highlight">Reminders</a></li><li><a href="#read-uncommitted" class="table-of-contents__link toc-highlight">Read Uncommitted</a></li><li><a href="#read-committed" class="table-of-contents__link toc-highlight">Read Committed</a></li><li><a href="#repeatable-read" class="table-of-contents__link toc-highlight">Repeatable Read</a></li><li><a href="#serializable" class="table-of-contents__link toc-highlight">Serializable</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d8d9fa14.js"></script>
<script src="/assets/js/main.a4125f30.js"></script>
</body>
</html>